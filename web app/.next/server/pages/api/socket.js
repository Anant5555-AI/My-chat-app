"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/socket";
exports.ids = ["pages/api/socket"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "socket.io":
/*!****************************!*\
  !*** external "socket.io" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("socket.io");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsocket&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csocket.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsocket&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csocket.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\socket.js */ \"(api)/./pages/api/socket.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/socket\",\n        pathname: \"/api/socket\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_socket_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNvY2tldCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDc29ja2V0LmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktY2hhdC1hcHAtd2ViLz8wYjE4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcc29ja2V0LmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc29ja2V0XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc29ja2V0XCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsocket&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csocket.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/auth/tokens.js":
/*!****************************!*\
  !*** ./lib/auth/tokens.js ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createTokens: () => (/* binding */ createTokens),\n/* harmony export */   verifyAccessToken: () => (/* binding */ verifyAccessToken),\n/* harmony export */   verifyRefreshToken: () => (/* binding */ verifyRefreshToken)\n/* harmony export */ });\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_0__);\n\nconst ACCESS_TOKEN_TTL_SECONDS = 15 * 60; // 15 minutes\nconst REFRESH_TOKEN_TTL_SECONDS = 7 * 24 * 60 * 60; // 7 days\nconst ACCESS_TOKEN_SECRET = process.env.ACCESS_TOKEN_SECRET;\nconst REFRESH_TOKEN_SECRET = process.env.REFRESH_TOKEN_SECRET;\nif (!ACCESS_TOKEN_SECRET || !REFRESH_TOKEN_SECRET) {\n    throw new Error(\"Please add token secrets to .env\");\n}\nfunction createTokens(user) {\n    const accessToken = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n        sub: user._id.toString(),\n        email: user.email\n    }, ACCESS_TOKEN_SECRET, {\n        expiresIn: ACCESS_TOKEN_TTL_SECONDS\n    });\n    const refreshToken = jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().sign({\n        sub: user._id.toString(),\n        email: user.email\n    }, REFRESH_TOKEN_SECRET, {\n        expiresIn: REFRESH_TOKEN_TTL_SECONDS\n    });\n    return {\n        accessToken,\n        refreshToken\n    };\n}\nfunction verifyAccessToken(token) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, ACCESS_TOKEN_SECRET);\n}\nfunction verifyRefreshToken(token) {\n    return jsonwebtoken__WEBPACK_IMPORTED_MODULE_0___default().verify(token, REFRESH_TOKEN_SECRET);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvYXV0aC90b2tlbnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBK0I7QUFFL0IsTUFBTUMsMkJBQTJCLEtBQUssSUFBSSxhQUFhO0FBQ3ZELE1BQU1DLDRCQUE0QixJQUFJLEtBQUssS0FBSyxJQUFJLFNBQVM7QUFFN0QsTUFBTUMsc0JBQXNCQyxRQUFRQyxHQUFHLENBQUNGLG1CQUFtQjtBQUMzRCxNQUFNRyx1QkFBdUJGLFFBQVFDLEdBQUcsQ0FBQ0Msb0JBQW9CO0FBRTdELElBQUksQ0FBQ0gsdUJBQXVCLENBQUNHLHNCQUFzQjtJQUNqRCxNQUFNLElBQUlDLE1BQU07QUFDbEI7QUFFTyxTQUFTQyxhQUFhQyxJQUFJO0lBQy9CLE1BQU1DLGNBQWNWLHdEQUFRLENBQzFCO1FBQUVZLEtBQUtILEtBQUtJLEdBQUcsQ0FBQ0MsUUFBUTtRQUFJQyxPQUFPTixLQUFLTSxLQUFLO0lBQUMsR0FDOUNaLHFCQUNBO1FBQUVhLFdBQVdmO0lBQXlCO0lBR3hDLE1BQU1nQixlQUFlakIsd0RBQVEsQ0FDM0I7UUFBRVksS0FBS0gsS0FBS0ksR0FBRyxDQUFDQyxRQUFRO1FBQUlDLE9BQU9OLEtBQUtNLEtBQUs7SUFBQyxHQUM5Q1Qsc0JBQ0E7UUFBRVUsV0FBV2Q7SUFBMEI7SUFHekMsT0FBTztRQUFFUTtRQUFhTztJQUFhO0FBQ3JDO0FBRU8sU0FBU0Msa0JBQWtCQyxLQUFLO0lBQ3JDLE9BQU9uQiwwREFBVSxDQUFDbUIsT0FBT2hCO0FBQzNCO0FBRU8sU0FBU2tCLG1CQUFtQkYsS0FBSztJQUN0QyxPQUFPbkIsMERBQVUsQ0FBQ21CLE9BQU9iO0FBQzNCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktY2hhdC1hcHAtd2ViLy4vbGliL2F1dGgvdG9rZW5zLmpzPzQ1MDkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XHJcblxyXG5jb25zdCBBQ0NFU1NfVE9LRU5fVFRMX1NFQ09ORFMgPSAxNSAqIDYwOyAvLyAxNSBtaW51dGVzXHJcbmNvbnN0IFJFRlJFU0hfVE9LRU5fVFRMX1NFQ09ORFMgPSA3ICogMjQgKiA2MCAqIDYwOyAvLyA3IGRheXNcclxuXHJcbmNvbnN0IEFDQ0VTU19UT0tFTl9TRUNSRVQgPSBwcm9jZXNzLmVudi5BQ0NFU1NfVE9LRU5fU0VDUkVUO1xyXG5jb25zdCBSRUZSRVNIX1RPS0VOX1NFQ1JFVCA9IHByb2Nlc3MuZW52LlJFRlJFU0hfVE9LRU5fU0VDUkVUO1xyXG5cclxuaWYgKCFBQ0NFU1NfVE9LRU5fU0VDUkVUIHx8ICFSRUZSRVNIX1RPS0VOX1NFQ1JFVCkge1xyXG4gIHRocm93IG5ldyBFcnJvcihcIlBsZWFzZSBhZGQgdG9rZW4gc2VjcmV0cyB0byAuZW52XCIpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVG9rZW5zKHVzZXIpIHtcclxuICBjb25zdCBhY2Nlc3NUb2tlbiA9IGp3dC5zaWduKFxyXG4gICAgeyBzdWI6IHVzZXIuX2lkLnRvU3RyaW5nKCksIGVtYWlsOiB1c2VyLmVtYWlsIH0sXHJcbiAgICBBQ0NFU1NfVE9LRU5fU0VDUkVULFxyXG4gICAgeyBleHBpcmVzSW46IEFDQ0VTU19UT0tFTl9UVExfU0VDT05EUyB9XHJcbiAgKTtcclxuXHJcbiAgY29uc3QgcmVmcmVzaFRva2VuID0gand0LnNpZ24oXHJcbiAgICB7IHN1YjogdXNlci5faWQudG9TdHJpbmcoKSwgZW1haWw6IHVzZXIuZW1haWwgfSxcclxuICAgIFJFRlJFU0hfVE9LRU5fU0VDUkVULFxyXG4gICAgeyBleHBpcmVzSW46IFJFRlJFU0hfVE9LRU5fVFRMX1NFQ09ORFMgfVxyXG4gICk7XHJcblxyXG4gIHJldHVybiB7IGFjY2Vzc1Rva2VuLCByZWZyZXNoVG9rZW4gfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZlcmlmeUFjY2Vzc1Rva2VuKHRva2VuKSB7XHJcbiAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIEFDQ0VTU19UT0tFTl9TRUNSRVQpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5UmVmcmVzaFRva2VuKHRva2VuKSB7XHJcbiAgcmV0dXJuIGp3dC52ZXJpZnkodG9rZW4sIFJFRlJFU0hfVE9LRU5fU0VDUkVUKTtcclxufVxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJqd3QiLCJBQ0NFU1NfVE9LRU5fVFRMX1NFQ09ORFMiLCJSRUZSRVNIX1RPS0VOX1RUTF9TRUNPTkRTIiwiQUNDRVNTX1RPS0VOX1NFQ1JFVCIsInByb2Nlc3MiLCJlbnYiLCJSRUZSRVNIX1RPS0VOX1NFQ1JFVCIsIkVycm9yIiwiY3JlYXRlVG9rZW5zIiwidXNlciIsImFjY2Vzc1Rva2VuIiwic2lnbiIsInN1YiIsIl9pZCIsInRvU3RyaW5nIiwiZW1haWwiLCJleHBpcmVzSW4iLCJyZWZyZXNoVG9rZW4iLCJ2ZXJpZnlBY2Nlc3NUb2tlbiIsInRva2VuIiwidmVyaWZ5IiwidmVyaWZ5UmVmcmVzaFRva2VuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/auth/tokens.js\n");

/***/ }),

/***/ "(api)/./pages/api/socket.js":
/*!*****************************!*\
  !*** ./pages/api/socket.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var socket_io__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io */ \"socket.io\");\n/* harmony import */ var _lib_auth_tokens__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth/tokens */ \"(api)/./lib/auth/tokens.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([socket_io__WEBPACK_IMPORTED_MODULE_0__]);\nsocket_io__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nfunction handler(req, res) {\n    if (!res.socket.server.io) {\n        const io = new socket_io__WEBPACK_IMPORTED_MODULE_0__.Server(res.socket.server, {\n            path: \"/socket.io\"\n        });\n        io.use((socket, next)=>{\n            const token = socket.handshake.auth?.token;\n            if (!token) return next(new Error(\"No token\"));\n            try {\n                const payload = (0,_lib_auth_tokens__WEBPACK_IMPORTED_MODULE_1__.verifyAccessToken)(token);\n                socket.userId = payload.sub;\n                return next();\n            } catch  {\n                return next(new Error(\"Invalid token\"));\n            }\n        });\n        io.on(\"connection\", (socket)=>{\n            const room = `user:${socket.userId}`;\n            socket.join(room);\n            socket.on(\"message\", async (payload)=>{\n                console.log(`[Socket] Received message from ${socket.userId}:`, payload);\n                try {\n                    const { getDb } = await __webpack_require__.e(/*! import() */ \"_api_lib_db_mongo_js\").then(__webpack_require__.bind(__webpack_require__, /*! @/lib/db/mongo */ \"(api)/./lib/db/mongo.js\"));\n                    const db = await getDb();\n                    const messages = db.collection(\"chats\");\n                    const doc = {\n                        ...payload,\n                        userId: socket.userId,\n                        savedAt: new Date()\n                    };\n                    console.log(`[Socket] Attempting to save to 'chats' collection for user ${socket.userId}`);\n                    // Upsert: Create the document if it doesn't exist, otherwise push to messages array\n                    const result = await messages.updateOne({\n                        userId: socket.userId\n                    }, {\n                        $push: {\n                            messages: doc\n                        }\n                    }, {\n                        upsert: true\n                    });\n                    console.log(`[Socket] Save result:`, result);\n                } catch (e) {\n                    console.error(\"[Socket] Failed to save message\", e);\n                }\n                // Broadcast to all of this user's devices (web + mobile) without inspecting ciphertext\n                io.to(room).emit(\"message\", payload);\n            });\n            socket.on(\"deleteMessage\", (id)=>{\n                console.log(`[Socket] Broadcasting delete for message ${id} to room ${room}`);\n                // Broadcast deletion event\n                io.to(room).emit(\"deleteMessage\", id);\n            });\n        });\n        res.socket.server.io = io;\n    }\n    res.end();\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc29ja2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBbUM7QUFDbUI7QUFFL0MsTUFBTUUsU0FBUztJQUNwQkMsS0FBSztRQUNIQyxZQUFZO0lBQ2Q7QUFDRixFQUFFO0FBRWEsU0FBU0MsUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQ3RDLElBQUksQ0FBQ0EsSUFBSUMsTUFBTSxDQUFDQyxNQUFNLENBQUNDLEVBQUUsRUFBRTtRQUN6QixNQUFNQSxLQUFLLElBQUlWLDZDQUFNQSxDQUFDTyxJQUFJQyxNQUFNLENBQUNDLE1BQU0sRUFBRTtZQUN2Q0UsTUFBTTtRQUNSO1FBRUFELEdBQUdFLEdBQUcsQ0FBQyxDQUFDSixRQUFRSztZQUNkLE1BQU1DLFFBQVFOLE9BQU9PLFNBQVMsQ0FBQ0MsSUFBSSxFQUFFRjtZQUNyQyxJQUFJLENBQUNBLE9BQU8sT0FBT0QsS0FBSyxJQUFJSSxNQUFNO1lBQ2xDLElBQUk7Z0JBQ0YsTUFBTUMsVUFBVWpCLG1FQUFpQkEsQ0FBQ2E7Z0JBQ2xDTixPQUFPVyxNQUFNLEdBQUdELFFBQVFFLEdBQUc7Z0JBQzNCLE9BQU9QO1lBQ1QsRUFBRSxPQUFNO2dCQUNOLE9BQU9BLEtBQUssSUFBSUksTUFBTTtZQUN4QjtRQUNGO1FBRUFQLEdBQUdXLEVBQUUsQ0FBQyxjQUFjLENBQUNiO1lBQ25CLE1BQU1jLE9BQU8sQ0FBQyxLQUFLLEVBQUVkLE9BQU9XLE1BQU0sQ0FBQyxDQUFDO1lBQ3BDWCxPQUFPZSxJQUFJLENBQUNEO1lBRVpkLE9BQU9hLEVBQUUsQ0FBQyxXQUFXLE9BQU9IO2dCQUMxQk0sUUFBUUMsR0FBRyxDQUFDLENBQUMsK0JBQStCLEVBQUVqQixPQUFPVyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUVEO2dCQUNoRSxJQUFJO29CQUNGLE1BQU0sRUFBRVEsS0FBSyxFQUFFLEdBQUcsTUFBTSxrS0FBd0I7b0JBQ2hELE1BQU1DLEtBQUssTUFBTUQ7b0JBQ2pCLE1BQU1FLFdBQVdELEdBQUdFLFVBQVUsQ0FBQztvQkFFL0IsTUFBTUMsTUFBTTt3QkFDVixHQUFHWixPQUFPO3dCQUNWQyxRQUFRWCxPQUFPVyxNQUFNO3dCQUNyQlksU0FBUyxJQUFJQztvQkFDZjtvQkFFQVIsUUFBUUMsR0FBRyxDQUFDLENBQUMsMkRBQTJELEVBQUVqQixPQUFPVyxNQUFNLENBQUMsQ0FBQztvQkFFekYsb0ZBQW9GO29CQUNwRixNQUFNYyxTQUFTLE1BQU1MLFNBQVNNLFNBQVMsQ0FDckM7d0JBQUVmLFFBQVFYLE9BQU9XLE1BQU07b0JBQUMsR0FDeEI7d0JBQUVnQixPQUFPOzRCQUFFUCxVQUFVRTt3QkFBSTtvQkFBRSxHQUMzQjt3QkFBRU0sUUFBUTtvQkFBSztvQkFFakJaLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHFCQUFxQixDQUFDLEVBQUVRO2dCQUN2QyxFQUFFLE9BQU9JLEdBQUc7b0JBQ1ZiLFFBQVFjLEtBQUssQ0FBQyxtQ0FBbUNEO2dCQUNuRDtnQkFFQSx1RkFBdUY7Z0JBQ3ZGM0IsR0FBRzZCLEVBQUUsQ0FBQ2pCLE1BQU1rQixJQUFJLENBQUMsV0FBV3RCO1lBQzlCO1lBRUFWLE9BQU9hLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQ29CO2dCQUMxQmpCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLHlDQUF5QyxFQUFFZ0IsR0FBRyxTQUFTLEVBQUVuQixLQUFLLENBQUM7Z0JBQzVFLDJCQUEyQjtnQkFDM0JaLEdBQUc2QixFQUFFLENBQUNqQixNQUFNa0IsSUFBSSxDQUFDLGlCQUFpQkM7WUFDcEM7UUFDRjtRQUVBbEMsSUFBSUMsTUFBTSxDQUFDQyxNQUFNLENBQUNDLEVBQUUsR0FBR0E7SUFDekI7SUFDQUgsSUFBSW1DLEdBQUc7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL215LWNoYXQtYXBwLXdlYi8uL3BhZ2VzL2FwaS9zb2NrZXQuanM/OTM1YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBTZXJ2ZXIgfSBmcm9tIFwic29ja2V0LmlvXCI7XHJcbmltcG9ydCB7IHZlcmlmeUFjY2Vzc1Rva2VuIH0gZnJvbSBcIkAvbGliL2F1dGgvdG9rZW5zXCI7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGFwaToge1xyXG4gICAgYm9keVBhcnNlcjogZmFsc2VcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgaWYgKCFyZXMuc29ja2V0LnNlcnZlci5pbykge1xyXG4gICAgY29uc3QgaW8gPSBuZXcgU2VydmVyKHJlcy5zb2NrZXQuc2VydmVyLCB7XHJcbiAgICAgIHBhdGg6IFwiL3NvY2tldC5pb1wiXHJcbiAgICB9KTtcclxuXHJcbiAgICBpby51c2UoKHNvY2tldCwgbmV4dCkgPT4ge1xyXG4gICAgICBjb25zdCB0b2tlbiA9IHNvY2tldC5oYW5kc2hha2UuYXV0aD8udG9rZW47XHJcbiAgICAgIGlmICghdG9rZW4pIHJldHVybiBuZXh0KG5ldyBFcnJvcihcIk5vIHRva2VuXCIpKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBwYXlsb2FkID0gdmVyaWZ5QWNjZXNzVG9rZW4odG9rZW4pO1xyXG4gICAgICAgIHNvY2tldC51c2VySWQgPSBwYXlsb2FkLnN1YjtcclxuICAgICAgICByZXR1cm4gbmV4dCgpO1xyXG4gICAgICB9IGNhdGNoIHtcclxuICAgICAgICByZXR1cm4gbmV4dChuZXcgRXJyb3IoXCJJbnZhbGlkIHRva2VuXCIpKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaW8ub24oXCJjb25uZWN0aW9uXCIsIChzb2NrZXQpID0+IHtcclxuICAgICAgY29uc3Qgcm9vbSA9IGB1c2VyOiR7c29ja2V0LnVzZXJJZH1gO1xyXG4gICAgICBzb2NrZXQuam9pbihyb29tKTtcclxuXHJcbiAgICAgIHNvY2tldC5vbihcIm1lc3NhZ2VcIiwgYXN5bmMgKHBheWxvYWQpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgW1NvY2tldF0gUmVjZWl2ZWQgbWVzc2FnZSBmcm9tICR7c29ja2V0LnVzZXJJZH06YCwgcGF5bG9hZCk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHsgZ2V0RGIgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL2RiL21vbmdvXCIpO1xyXG4gICAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xyXG4gICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBkYi5jb2xsZWN0aW9uKFwiY2hhdHNcIik7XHJcblxyXG4gICAgICAgICAgY29uc3QgZG9jID0ge1xyXG4gICAgICAgICAgICAuLi5wYXlsb2FkLFxyXG4gICAgICAgICAgICB1c2VySWQ6IHNvY2tldC51c2VySWQsXHJcbiAgICAgICAgICAgIHNhdmVkQXQ6IG5ldyBEYXRlKClcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgY29uc29sZS5sb2coYFtTb2NrZXRdIEF0dGVtcHRpbmcgdG8gc2F2ZSB0byAnY2hhdHMnIGNvbGxlY3Rpb24gZm9yIHVzZXIgJHtzb2NrZXQudXNlcklkfWApO1xyXG5cclxuICAgICAgICAgIC8vIFVwc2VydDogQ3JlYXRlIHRoZSBkb2N1bWVudCBpZiBpdCBkb2Vzbid0IGV4aXN0LCBvdGhlcndpc2UgcHVzaCB0byBtZXNzYWdlcyBhcnJheVxyXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbWVzc2FnZXMudXBkYXRlT25lKFxyXG4gICAgICAgICAgICB7IHVzZXJJZDogc29ja2V0LnVzZXJJZCB9LFxyXG4gICAgICAgICAgICB7ICRwdXNoOiB7IG1lc3NhZ2VzOiBkb2MgfSB9LFxyXG4gICAgICAgICAgICB7IHVwc2VydDogdHJ1ZSB9XHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coYFtTb2NrZXRdIFNhdmUgcmVzdWx0OmAsIHJlc3VsdCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIltTb2NrZXRdIEZhaWxlZCB0byBzYXZlIG1lc3NhZ2VcIiwgZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBCcm9hZGNhc3QgdG8gYWxsIG9mIHRoaXMgdXNlcidzIGRldmljZXMgKHdlYiArIG1vYmlsZSkgd2l0aG91dCBpbnNwZWN0aW5nIGNpcGhlcnRleHRcclxuICAgICAgICBpby50byhyb29tKS5lbWl0KFwibWVzc2FnZVwiLCBwYXlsb2FkKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBzb2NrZXQub24oXCJkZWxldGVNZXNzYWdlXCIsIChpZCkgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBbU29ja2V0XSBCcm9hZGNhc3RpbmcgZGVsZXRlIGZvciBtZXNzYWdlICR7aWR9IHRvIHJvb20gJHtyb29tfWApO1xyXG4gICAgICAgIC8vIEJyb2FkY2FzdCBkZWxldGlvbiBldmVudFxyXG4gICAgICAgIGlvLnRvKHJvb20pLmVtaXQoXCJkZWxldGVNZXNzYWdlXCIsIGlkKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXMuc29ja2V0LnNlcnZlci5pbyA9IGlvO1xyXG4gIH1cclxuICByZXMuZW5kKCk7XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiU2VydmVyIiwidmVyaWZ5QWNjZXNzVG9rZW4iLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInNvY2tldCIsInNlcnZlciIsImlvIiwicGF0aCIsInVzZSIsIm5leHQiLCJ0b2tlbiIsImhhbmRzaGFrZSIsImF1dGgiLCJFcnJvciIsInBheWxvYWQiLCJ1c2VySWQiLCJzdWIiLCJvbiIsInJvb20iLCJqb2luIiwiY29uc29sZSIsImxvZyIsImdldERiIiwiZGIiLCJtZXNzYWdlcyIsImNvbGxlY3Rpb24iLCJkb2MiLCJzYXZlZEF0IiwiRGF0ZSIsInJlc3VsdCIsInVwZGF0ZU9uZSIsIiRwdXNoIiwidXBzZXJ0IiwiZSIsImVycm9yIiwidG8iLCJlbWl0IiwiaWQiLCJlbmQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/socket.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsocket&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csocket.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();