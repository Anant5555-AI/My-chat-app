"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_ssr_lib_encryption_js";
exports.ids = ["_ssr_lib_encryption_js"];
exports.modules = {

/***/ "(ssr)/./lib/encryption.js":
/*!***************************!*\
  !*** ./lib/encryption.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EncryptionService: () => (/* binding */ EncryptionService)\n/* harmony export */ });\n/* harmony import */ var crypto_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto-js */ \"(ssr)/./node_modules/crypto-js/index.js\");\n/* harmony import */ var crypto_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto_js__WEBPACK_IMPORTED_MODULE_0__);\n\n// Matches mobile_new/src/services/EncryptionService.js logic for compatibility\nclass EncryptionService {\n    /**\r\n     * Generate a random symmetric key (hex string)\r\n     */ static generateSymmetricKey() {\n        return crypto_js__WEBPACK_IMPORTED_MODULE_0___default().lib.WordArray.random(32).toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex);\n    }\n    /**\r\n     * Generate a key pair\r\n     * Note: Matches mobile implementation of simulated key pair\r\n     */ static generateKeyPair() {\n        return {\n            publicKey: crypto_js__WEBPACK_IMPORTED_MODULE_0___default().lib.WordArray.random(32).toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex),\n            privateKey: crypto_js__WEBPACK_IMPORTED_MODULE_0___default().lib.WordArray.random(32).toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex)\n        };\n    }\n    /**\r\n     * Derive a shared secret\r\n     * Logic: SHA256(privateKey + otherPublicKey)\r\n     */ static computeSharedSecret(privateKeyHex, otherPublicKeyHex) {\n        if (!privateKeyHex || !otherPublicKeyHex) return null;\n        const combined = privateKeyHex + otherPublicKeyHex;\n        return crypto_js__WEBPACK_IMPORTED_MODULE_0___default().SHA256(combined).toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex);\n    }\n    /**\r\n     * Encrypt a message\r\n     */ static encrypt(message, sharedSecret) {\n        const iv = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().lib.WordArray.random(16);\n        const key = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().SHA256(sharedSecret); // Ensure 32-byte key\n        const encrypted = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().AES.encrypt(message, key, {\n            iv: iv,\n            mode: (crypto_js__WEBPACK_IMPORTED_MODULE_0___default().mode).CBC,\n            padding: (crypto_js__WEBPACK_IMPORTED_MODULE_0___default().pad).Pkcs7\n        });\n        return {\n            encrypted: encrypted.ciphertext.toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex),\n            iv: iv.toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Hex),\n            authTag: \"0000000000000000\" // Fake auth tag as CBC doesn't have it\n        };\n    }\n    /**\r\n     * Decrypt a message\r\n     */ static decrypt(encryptedHex, ivHex, authTagHex, sharedSecret) {\n        try {\n            const key = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().SHA256(sharedSecret);\n            const iv = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc.Hex.parse(ivHex);\n            const ciphertext = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc.Hex.parse(encryptedHex);\n            const cipherParams = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().lib.CipherParams.create({\n                ciphertext: ciphertext\n            });\n            const decrypted = crypto_js__WEBPACK_IMPORTED_MODULE_0___default().AES.decrypt(cipherParams, key, {\n                iv: iv,\n                mode: (crypto_js__WEBPACK_IMPORTED_MODULE_0___default().mode).CBC,\n                padding: (crypto_js__WEBPACK_IMPORTED_MODULE_0___default().pad).Pkcs7\n            });\n            return decrypted.toString((crypto_js__WEBPACK_IMPORTED_MODULE_0___default().enc).Utf8);\n        } catch (e) {\n            console.error(\"Decryption failed\", e);\n            return \"[Decryption Error]\";\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9saWIvZW5jcnlwdGlvbi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBaUM7QUFFakMsK0VBQStFO0FBQ3hFLE1BQU1DO0lBQ1Q7O0tBRUMsR0FDRCxPQUFPQyx1QkFBdUI7UUFDMUIsT0FBT0Ysb0RBQVksQ0FBQ0ksU0FBUyxDQUFDQyxNQUFNLENBQUMsSUFBSUMsUUFBUSxDQUFDTixzREFBWSxDQUFDUSxHQUFHO0lBQ3RFO0lBRUE7OztLQUdDLEdBQ0QsT0FBT0Msa0JBQWtCO1FBQ3JCLE9BQU87WUFDSEMsV0FBV1Ysb0RBQVksQ0FBQ0ksU0FBUyxDQUFDQyxNQUFNLENBQUMsSUFBSUMsUUFBUSxDQUFDTixzREFBWSxDQUFDUSxHQUFHO1lBQ3RFRyxZQUFZWCxvREFBWSxDQUFDSSxTQUFTLENBQUNDLE1BQU0sQ0FBQyxJQUFJQyxRQUFRLENBQUNOLHNEQUFZLENBQUNRLEdBQUc7UUFDM0U7SUFDSjtJQUVBOzs7S0FHQyxHQUNELE9BQU9JLG9CQUFvQkMsYUFBYSxFQUFFQyxpQkFBaUIsRUFBRTtRQUN6RCxJQUFJLENBQUNELGlCQUFpQixDQUFDQyxtQkFBbUIsT0FBTztRQUNqRCxNQUFNQyxXQUFXRixnQkFBZ0JDO1FBQ2pDLE9BQU9kLHVEQUFlLENBQUNlLFVBQVVULFFBQVEsQ0FBQ04sc0RBQVksQ0FBQ1EsR0FBRztJQUM5RDtJQUVBOztLQUVDLEdBQ0QsT0FBT1MsUUFBUUMsT0FBTyxFQUFFQyxZQUFZLEVBQUU7UUFDbEMsTUFBTUMsS0FBS3BCLG9EQUFZLENBQUNJLFNBQVMsQ0FBQ0MsTUFBTSxDQUFDO1FBQ3pDLE1BQU1nQixNQUFNckIsdURBQWUsQ0FBQ21CLGVBQWUscUJBQXFCO1FBRWhFLE1BQU1HLFlBQVl0QixvREFBWSxDQUFDaUIsT0FBTyxDQUFDQyxTQUFTRyxLQUFLO1lBQ2pERCxJQUFJQTtZQUNKSSxNQUFNeEIsdURBQWEsQ0FBQ3lCLEdBQUc7WUFDdkJDLFNBQVMxQixzREFBWSxDQUFDNEIsS0FBSztRQUMvQjtRQUVBLE9BQU87WUFDSE4sV0FBV0EsVUFBVU8sVUFBVSxDQUFDdkIsUUFBUSxDQUFDTixzREFBWSxDQUFDUSxHQUFHO1lBQ3pEWSxJQUFJQSxHQUFHZCxRQUFRLENBQUNOLHNEQUFZLENBQUNRLEdBQUc7WUFDaENzQixTQUFTLG1CQUFtQix1Q0FBdUM7UUFDdkU7SUFDSjtJQUVBOztLQUVDLEdBQ0QsT0FBT0MsUUFBUUMsWUFBWSxFQUFFQyxLQUFLLEVBQUVDLFVBQVUsRUFBRWYsWUFBWSxFQUFFO1FBQzFELElBQUk7WUFDQSxNQUFNRSxNQUFNckIsdURBQWUsQ0FBQ21CO1lBQzVCLE1BQU1DLEtBQUtwQixvREFBWSxDQUFDUSxHQUFHLENBQUMyQixLQUFLLENBQUNGO1lBQ2xDLE1BQU1KLGFBQWE3QixvREFBWSxDQUFDUSxHQUFHLENBQUMyQixLQUFLLENBQUNIO1lBRTFDLE1BQU1JLGVBQWVwQyxvREFBWSxDQUFDcUMsWUFBWSxDQUFDQyxNQUFNLENBQUM7Z0JBQ2xEVCxZQUFZQTtZQUNoQjtZQUVBLE1BQU1VLFlBQVl2QyxvREFBWSxDQUFDK0IsT0FBTyxDQUFDSyxjQUFjZixLQUFLO2dCQUN0REQsSUFBSUE7Z0JBQ0pJLE1BQU14Qix1REFBYSxDQUFDeUIsR0FBRztnQkFDdkJDLFNBQVMxQixzREFBWSxDQUFDNEIsS0FBSztZQUMvQjtZQUVBLE9BQU9XLFVBQVVqQyxRQUFRLENBQUNOLHNEQUFZLENBQUN3QyxJQUFJO1FBQy9DLEVBQUUsT0FBT0MsR0FBRztZQUNSQyxRQUFRQyxLQUFLLENBQUMscUJBQXFCRjtZQUNuQyxPQUFPO1FBQ1g7SUFDSjtBQUNKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktY2hhdC1hcHAtd2ViLy4vbGliL2VuY3J5cHRpb24uanM/NmViMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ3J5cHRvSlMgZnJvbSAnY3J5cHRvLWpzJztcclxuXHJcbi8vIE1hdGNoZXMgbW9iaWxlX25ldy9zcmMvc2VydmljZXMvRW5jcnlwdGlvblNlcnZpY2UuanMgbG9naWMgZm9yIGNvbXBhdGliaWxpdHlcclxuZXhwb3J0IGNsYXNzIEVuY3J5cHRpb25TZXJ2aWNlIHtcclxuICAgIC8qKlxyXG4gICAgICogR2VuZXJhdGUgYSByYW5kb20gc3ltbWV0cmljIGtleSAoaGV4IHN0cmluZylcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdlbmVyYXRlU3ltbWV0cmljS2V5KCkge1xyXG4gICAgICAgIHJldHVybiBDcnlwdG9KUy5saWIuV29yZEFycmF5LnJhbmRvbSgzMikudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLkhleCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZW5lcmF0ZSBhIGtleSBwYWlyXHJcbiAgICAgKiBOb3RlOiBNYXRjaGVzIG1vYmlsZSBpbXBsZW1lbnRhdGlvbiBvZiBzaW11bGF0ZWQga2V5IHBhaXJcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGdlbmVyYXRlS2V5UGFpcigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwdWJsaWNLZXk6IENyeXB0b0pTLmxpYi5Xb3JkQXJyYXkucmFuZG9tKDMyKS50b1N0cmluZyhDcnlwdG9KUy5lbmMuSGV4KSxcclxuICAgICAgICAgICAgcHJpdmF0ZUtleTogQ3J5cHRvSlMubGliLldvcmRBcnJheS5yYW5kb20oMzIpLnRvU3RyaW5nKENyeXB0b0pTLmVuYy5IZXgpLFxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBEZXJpdmUgYSBzaGFyZWQgc2VjcmV0XHJcbiAgICAgKiBMb2dpYzogU0hBMjU2KHByaXZhdGVLZXkgKyBvdGhlclB1YmxpY0tleSlcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGNvbXB1dGVTaGFyZWRTZWNyZXQocHJpdmF0ZUtleUhleCwgb3RoZXJQdWJsaWNLZXlIZXgpIHtcclxuICAgICAgICBpZiAoIXByaXZhdGVLZXlIZXggfHwgIW90aGVyUHVibGljS2V5SGV4KSByZXR1cm4gbnVsbDtcclxuICAgICAgICBjb25zdCBjb21iaW5lZCA9IHByaXZhdGVLZXlIZXggKyBvdGhlclB1YmxpY0tleUhleDtcclxuICAgICAgICByZXR1cm4gQ3J5cHRvSlMuU0hBMjU2KGNvbWJpbmVkKS50b1N0cmluZyhDcnlwdG9KUy5lbmMuSGV4KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEVuY3J5cHQgYSBtZXNzYWdlXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBlbmNyeXB0KG1lc3NhZ2UsIHNoYXJlZFNlY3JldCkge1xyXG4gICAgICAgIGNvbnN0IGl2ID0gQ3J5cHRvSlMubGliLldvcmRBcnJheS5yYW5kb20oMTYpO1xyXG4gICAgICAgIGNvbnN0IGtleSA9IENyeXB0b0pTLlNIQTI1NihzaGFyZWRTZWNyZXQpOyAvLyBFbnN1cmUgMzItYnl0ZSBrZXlcclxuXHJcbiAgICAgICAgY29uc3QgZW5jcnlwdGVkID0gQ3J5cHRvSlMuQUVTLmVuY3J5cHQobWVzc2FnZSwga2V5LCB7XHJcbiAgICAgICAgICAgIGl2OiBpdixcclxuICAgICAgICAgICAgbW9kZTogQ3J5cHRvSlMubW9kZS5DQkMsXHJcbiAgICAgICAgICAgIHBhZGRpbmc6IENyeXB0b0pTLnBhZC5Qa2NzN1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBlbmNyeXB0ZWQ6IGVuY3J5cHRlZC5jaXBoZXJ0ZXh0LnRvU3RyaW5nKENyeXB0b0pTLmVuYy5IZXgpLFxyXG4gICAgICAgICAgICBpdjogaXYudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLkhleCksXHJcbiAgICAgICAgICAgIGF1dGhUYWc6ICcwMDAwMDAwMDAwMDAwMDAwJyAvLyBGYWtlIGF1dGggdGFnIGFzIENCQyBkb2Vzbid0IGhhdmUgaXRcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGVjcnlwdCBhIG1lc3NhZ2VcclxuICAgICAqL1xyXG4gICAgc3RhdGljIGRlY3J5cHQoZW5jcnlwdGVkSGV4LCBpdkhleCwgYXV0aFRhZ0hleCwgc2hhcmVkU2VjcmV0KSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gQ3J5cHRvSlMuU0hBMjU2KHNoYXJlZFNlY3JldCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGl2ID0gQ3J5cHRvSlMuZW5jLkhleC5wYXJzZShpdkhleCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNpcGhlcnRleHQgPSBDcnlwdG9KUy5lbmMuSGV4LnBhcnNlKGVuY3J5cHRlZEhleCk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCBjaXBoZXJQYXJhbXMgPSBDcnlwdG9KUy5saWIuQ2lwaGVyUGFyYW1zLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICBjaXBoZXJ0ZXh0OiBjaXBoZXJ0ZXh0XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoY2lwaGVyUGFyYW1zLCBrZXksIHtcclxuICAgICAgICAgICAgICAgIGl2OiBpdixcclxuICAgICAgICAgICAgICAgIG1vZGU6IENyeXB0b0pTLm1vZGUuQ0JDLFxyXG4gICAgICAgICAgICAgICAgcGFkZGluZzogQ3J5cHRvSlMucGFkLlBrY3M3XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRlY3J5cHRlZC50b1N0cmluZyhDcnlwdG9KUy5lbmMuVXRmOCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRGVjcnlwdGlvbiBmYWlsZWRcIiwgZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBcIltEZWNyeXB0aW9uIEVycm9yXVwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ3J5cHRvSlMiLCJFbmNyeXB0aW9uU2VydmljZSIsImdlbmVyYXRlU3ltbWV0cmljS2V5IiwibGliIiwiV29yZEFycmF5IiwicmFuZG9tIiwidG9TdHJpbmciLCJlbmMiLCJIZXgiLCJnZW5lcmF0ZUtleVBhaXIiLCJwdWJsaWNLZXkiLCJwcml2YXRlS2V5IiwiY29tcHV0ZVNoYXJlZFNlY3JldCIsInByaXZhdGVLZXlIZXgiLCJvdGhlclB1YmxpY0tleUhleCIsImNvbWJpbmVkIiwiU0hBMjU2IiwiZW5jcnlwdCIsIm1lc3NhZ2UiLCJzaGFyZWRTZWNyZXQiLCJpdiIsImtleSIsImVuY3J5cHRlZCIsIkFFUyIsIm1vZGUiLCJDQkMiLCJwYWRkaW5nIiwicGFkIiwiUGtjczciLCJjaXBoZXJ0ZXh0IiwiYXV0aFRhZyIsImRlY3J5cHQiLCJlbmNyeXB0ZWRIZXgiLCJpdkhleCIsImF1dGhUYWdIZXgiLCJwYXJzZSIsImNpcGhlclBhcmFtcyIsIkNpcGhlclBhcmFtcyIsImNyZWF0ZSIsImRlY3J5cHRlZCIsIlV0ZjgiLCJlIiwiY29uc29sZSIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./lib/encryption.js\n");

/***/ })

};
;